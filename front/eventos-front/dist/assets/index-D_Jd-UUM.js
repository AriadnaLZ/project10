(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&t(c)}).observe(document,{childList:!0,subtree:!0});function n(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(e){if(e.ep)return;e.ep=!0;const o=n(e);fetch(e.href,o)}})();const L=async()=>{const a=document.querySelector("main");a.innerHTML=" ",document.createElement("h2");const s=document.createElement("section");s.className="sectionAnterioresViajes",a.append(s);const t=await(await fetch("http://localhost:8000/api/v1/eventosPasados")).json();T(t,s)},T=(a,s)=>{for(const n of a){const t=document.createElement("article");t.className="articleEventoPasado",s.append(t);const e=document.createElement("img");e.className="imgEventoPasado",e.src=n.imagen,t.append(e);const o=document.createElement("h3");o.className="tituloEventoPasado",o.innerText=n.titulo,t.append(o)}},x=["https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716892443/Proyecto%2010/paris.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716893665/Proyecto%2010/tokio.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716893966/Proyecto%2010/newyork.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716894061/Proyecto%2010/sidney.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716894092/Proyecto%2010/elcairo.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716894159/Proyecto%2010/roma.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716894193/Proyecto%2010/londres.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716894234/Proyecto%2010/barcelona.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716894266/Proyecto%2010/bali.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716894308/Proyecto%2010/cancun.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716894356/Proyecto%2010/ciudaddelcabo.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716894389/Proyecto%2010/honolulu.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716894468/Proyecto%2010/estambul.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716894494/Proyecto%2010/atenas.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716894557/Proyecto%2010/venecia.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716893116/Proyecto%2010/berlin.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716893163/Proyecto%2010/riodejaneiro.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716893287/Proyecto%2010/bangkok.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716893371/Proyecto%2010/moscu.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716893467/Proyecto%2010/sanfrancisco.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716893503/Proyecto%2010/toronto.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716893541/Proyecto%2010/dubai.jpg","https://res.cloudinary.com/dgyeaj8pu/image/upload/v1716893595/Proyecto%2010/buenosaires.jpg"],j=()=>{const a=document.querySelector("main");a.innerHTML="";const s=document.createElement("section");s.className="sectionImages",a.append(s);for(const n of x){const t=document.createElement("article");t.className="articleImage",s.append(t);const e=document.createElement("img");e.className="imgHome",e.src=n,t.append(e)}};let f,A;const S=()=>{const a=document.querySelector("main");a.innerHTML=" ";const s=document.createElement("section");s.className="sectionButtonsLogin",a.append(s);const n=document.createElement("button");n.className="buttonLogin",n.innerText="Login",s.append(n),n.addEventListener("click",()=>{a.innerHTML="",b(a)});const t=document.createElement("button");t.innerText="Registro",t.className="buttonLogin",s.append(t),t.addEventListener("click",()=>{a.innerHTML="",H(a)})},b=a=>{const s=document.querySelector("main");s.innerHTML="";const n=document.createElement("form");n.className="formLogin";const t=document.createElement("input");t.placeholder="Usuario";const e=document.createElement("input");e.placeholder="Contraseña";const o=document.createElement("button");return o.className="buttonLogin",o.textContent="Login",e.type="password",a.append(n),n.append(t),n.append(e),n.append(o),n.addEventListener("submit",()=>{f=t.value,w(t.value,e.value,n)}),A},w=async(a,s,n)=>{const t=JSON.stringify({userName:a,password:s});console.log(a,s);const e=await fetch("http://localhost:8000/api/v1/users/login",{method:"POST",body:t,headers:{"Content-Type":"application/json"}});if(e.status===400){const r=document.createElement("p");r.innerText="Usuario o contraseña incorrectos",r.className="pError",n.append(r);return}const o=document.querySelector(".error");o&&o.remove();const c=await e.json();console.log(c),localStorage.setItem("token",c.token),localStorage.setItem("user",JSON.stringify(c.user)),localStorage.setItem("email",JSON.stringify(c.user.email)),j()},H=async a=>{const s=document.createElement("form");s.className="formLogin";const n=document.createElement("input");n.placeholder="Nombre completo";const t=document.createElement("input");t.placeholder="Usuario";const e=document.createElement("input");e.placeholder="Contraseña";const o=document.createElement("input");o.placeholder="Email",o.type="email";const c=document.createElement("input");c.placeholder="Teléfono";const r=document.createElement("button");r.className="buttonLogin",r.textContent="Registrarse",e.type="password",a.append(s),s.append(n),s.append(t),s.append(e),s.append(o),s.append(c),s.append(r),s.addEventListener("submit",async()=>{f=t.value;const p=o.value;n.value,c.value;const v=await(await fetch("http://localhost:8000/api/v1/users")).json(),g=[],y=[];for(const i of v)g.push(i.userName),y.push(i.email);if(g.includes(f)){const i=document.createElement("p");i.className="pError",i.innerText="Este usuario ya existe",s.append(i)}else if(y.includes(p)){const i=document.createElement("p");i.className="pError",i.innerText="Este email ya existe",s.append(i)}else{k(t.value,e.value,o.value,n.value,c.value);const i=document.querySelector("main");i.innerHTML=" ";const d=document.createElement("div");d.className="divRegistro",i.append(d);const l=document.createElement("h2");l.innerText="Te has registrado correctamente",d.append(l);const m=document.createElement("button");m.innerText="Login",m.className="buttonLogin",d.append(m),m.addEventListener("click",()=>{b(i)})}})},k=async(a,s,n,t,e,o)=>{const c=JSON.stringify({userName:a,password:s,email:n}),r=await fetch("http://localhost:8000/api/v1/users/register",{method:"POST",body:c,headers:{"Content-Type":"application/json"}}),p=JSON.stringify({nombre:t,email:n,telefono:e}),u=await fetch("http://localhost:8000/api/v1/asistentes/",{method:"POST",body:p,headers:{"Content-Type":"application/json"}}),v=await r.json(),g=await u.json();console.log(g,v)},I=async(a,s,n)=>{const t=document.querySelector("main");t.innerHTML="";const e=document.createElement("section");e.className="sectionNuevoAsistente",t.append(e);const o=document.createElement("h2");o.innerText=s,o.className="tituloNuevoAsistente",e.append(o);const c=document.createElement("article");e.append(c),c.className="articleAsistentes";for(const p of n){const u=document.createElement("p");u.innerText=`🛩️ Nombre: ${p.nombre} 
   Email: ${p.email} `,c.append(u),u.className="pNombre"}const r=document.createElement("button");r.className="buttonAsistente",r.innerText="Volver",e.append(r),r.addEventListener("click",h)},O=async(a,s,n)=>{const t=document.querySelector("main");t.innerHTML="";const e=document.createElement("section");e.className="sectionNuevoAsistente",t.append(e);const o=document.createElement("h2");o.innerText=s,o.className="tituloNuevoAsistente",e.append(o);const c=document.createElement("article");e.append(c);let r=localStorage.getItem("email"),p;const v=await(await fetch("http://localhost:8000/api/v1/asistentes")).json();for(const l of v)`"${l.email}"`==r&&(p=l._id);const i=(await(await fetch(`http://localhost:8000/api/v1/eventos/${a}/`)).json()).asistentes;let d=[];for(const l of i)d.push(l._id);if(console.log(p,d),d.includes(p)){const l=document.createElement("p");l.innerText="Ya estás inscrito en este evento",l.className="pError",e.append(l);const m=document.createElement("button");m.className="buttonAsistente",m.innerText="Volver",e.append(m),m.addEventListener("click",h)}else{const l={method:"PUT",headers:{"Content-Type":"aplication/json",Authorization:`Bearer ${localStorage.getItem("token")}`}};await fetch(`http://localhost:8000/api/v1/eventos/${a}/${p}`,l);const m=document.createElement("p");m.className="pAceptado",m.innerText="Te has registrado correctamente",e.append(m);const E=document.createElement("button");E.className="buttonAsistente",E.innerText="Volver",e.append(E),E.addEventListener("click",h)}},h=async()=>{const a=document.querySelector("main");a.innerHTML=" ";const n=await(await fetch("http://localhost:8000/api/v1/eventos")).json(),t=document.createElement("section");t.className="sectionProximosViajes",a.append(t),R(n,t)},R=(a,s)=>{for(const n of a){const t=document.createElement("article");t.className="articleEvento",s.append(t);const e=document.createElement("img");e.className="imgEventoProximo",e.src=n.imagen,t.append(e);const o=document.createElement("div");o.className="divTitulo",t.append(o);const c=document.createElement("h3");c.className="tituloEvento",c.innerText=n.titulo,o.append(c);const r=document.createElement("p");r.className="precio",r.innerText=`Precio: ${n.precio}€`,t.append(r);const p=document.createElement("div");p.className="divDescripcion",t.append(p);const u=document.createElement("p");if(u.className="descripcion",u.innerText=n.descripcion,p.append(u),localStorage.getItem("token")){const v=document.createElement("div");v.className="divButtonAsistente",t.append(v);const g=document.createElement("button");g.className="buttonAsistente",g.innerText="Apúntate!",v.append(g),g.addEventListener("click",()=>{const d=n._id,l=n.titulo;n.asistentes,O(d,l)});const y=document.createElement("div");t.append(y);const i=document.createElement("p");i.className="pAsistentes",i.innerText="Ver asistentes",y.append(i),i.addEventListener("click",()=>{const d=n._id,l=n.titulo,m=n.asistentes;I(d,l,m)})}}},M=[{texto:"Home",funcion:j},{texto:"Login/Registro",funcion:S},{texto:"Próximos Viajes",funcion:h},{texto:"Anteriores Viajes",funcion:L}],P=()=>{const a=document.querySelector("header");a.innerHTML="";const s=document.createElement("h1");s.textContent="Viajando por el mundo 🌍✈️";const n=document.createElement("div");n.className="divHeader";const t=document.createElement("nav");for(const e of M){const o=document.createElement("a");o.href="#",e.texto==="Login"&&localStorage.getItem("token")?(o.textContent="Logout",o.addEventListener("click",()=>{localStorage.removeItem("token"),P()})):(o.textContent=e.texto,o.addEventListener("click",e.funcion)),t.append(o)}a.append(s),a.append(n),n.append(t),j()},N=document.querySelector("#app"),q=document.createElement("header"),C=document.createElement("main"),V=document.createElement("footer");N.append(q);N.append(C);N.append(V);P();
